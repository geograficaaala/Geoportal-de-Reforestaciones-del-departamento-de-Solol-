<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Módulo Reforestación · Sololá</title>
  <meta name="description" content="Pantalla de navegación del módulo de reforestación de Sololá." />
  <style>
:root{
  --bg1:#ecfbf6;
  --bg2:#e8f4ff;
  --bg3:#f8fffc;
  --ink:#123730;
  --muted:#56756d;
  --line:rgba(18,55,48,.10);
  --line2:rgba(18,55,48,.06);
  --panel:rgba(255,255,255,.80);
  --panel2:rgba(255,255,255,.92);
  --teal:#1f7f6f;
  --teal2:#2f9f89;
  --sky:#2e7fca;
  --shadow:0 18px 42px rgba(23,75,72,.10);
  --shadow2:0 10px 22px rgba(23,75,72,.08);
  --r1:22px;
  --r2:16px;
  --r3:12px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  color:var(--ink);
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background:
    radial-gradient(1100px 650px at 0% -10%, rgba(94,221,173,.22), transparent 62%),
    radial-gradient(900px 620px at 100% 0%, rgba(112,182,255,.20), transparent 62%),
    linear-gradient(130deg,var(--bg1),var(--bg2) 55%,var(--bg3));
}
main{width:min(1180px, calc(100% - 24px)); margin:14px auto 20px; position:relative; z-index:1;}
.orb{position:fixed; width:260px; height:260px; border-radius:999px; filter:blur(14px); opacity:.45; pointer-events:none; z-index:0;}
.orb.a{left:-80px; top:80px; background:radial-gradient(circle at 35% 35%, rgba(61,212,156,.30), rgba(61,212,156,0) 72%)}
.orb.b{right:-70px; top:20px; background:radial-gradient(circle at 35% 35%, rgba(96,170,255,.28), rgba(96,170,255,0) 72%)}
.topbar{display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap; margin-bottom:12px; padding:2px 2px 0}
.brand{display:flex; align-items:center; gap:10px; color:var(--muted); font-size:12px; font-weight:700; letter-spacing:.02em}
.brand .dot{width:10px; height:10px; border-radius:50%; background:linear-gradient(135deg,#31d39b,#71bcff); box-shadow:0 0 0 5px rgba(49,211,155,.15)}
.stack{display:grid; gap:12px}
.panel{background:linear-gradient(180deg,var(--panel2),var(--panel)); border:1px solid rgba(255,255,255,.75); border-radius:var(--r1); box-shadow:var(--shadow); backdrop-filter:blur(10px)}
.hero{display:grid; grid-template-columns:1.15fr .85fr; gap:12px}
.hero-main{padding:18px; position:relative; overflow:hidden}
.hero-main::after{content:""; position:absolute; right:-35px; top:-20px; width:210px; height:210px; border-radius:50%; background:radial-gradient(circle at 35% 35%, rgba(66,212,159,.16), transparent 72%)}
.hero-main::before{content:""; position:absolute; left:-35px; bottom:-45px; width:240px; height:240px; border-radius:50%; background:radial-gradient(circle at 40% 40%, rgba(100,169,255,.14), transparent 72%)}
.kicker{display:flex; gap:8px; flex-wrap:wrap; margin-bottom:12px}
.badge{display:inline-flex; align-items:center; gap:7px; border-radius:999px; padding:7px 11px; font-size:12px; font-weight:800; border:1px solid rgba(22,99,87,.10); color:#0f5044; background:linear-gradient(135deg, rgba(191,244,224,.95), rgba(219,237,255,.94))}
.badge .led{width:8px;height:8px;border-radius:50%;background:#2fd08f;box-shadow:0 0 0 4px rgba(47,208,143,.14)}
h1{margin:0; font-size:clamp(24px,3.5vw,36px); line-height:1.06; letter-spacing:-.02em; max-width:20ch}
.hero p{margin:10px 0 0; color:var(--muted); font-size:14px; line-height:1.45; max-width:68ch}
.actions{display:flex; gap:10px; flex-wrap:wrap; margin-top:14px}
.btn{display:inline-flex; align-items:center; justify-content:center; gap:8px; text-decoration:none; border-radius:14px; padding:10px 14px; font-weight:800; font-size:13px; line-height:1; transition:.15s transform ease,.15s box-shadow ease,.15s background ease,.15s border-color ease; white-space:nowrap}
.btn:hover{transform:translateY(-1px)}
.btn.primary{background:linear-gradient(135deg,#bff4df,#cfe8ff); color:#0b3f36; border:1px solid rgba(33,120,108,.12); box-shadow:0 10px 22px rgba(32,124,114,.14)}
.btn.outline{background:rgba(255,255,255,.86); color:var(--ink); border:1px solid var(--line); box-shadow:0 6px 16px rgba(23,75,72,.06)}
.btn.soft{background:#fff; color:var(--teal); border:1px solid var(--line2)}
.hero-side{padding:14px; display:grid; gap:10px; align-content:start}
.side-title{display:flex; justify-content:space-between; align-items:center; gap:8px}
.side-title h2{margin:0; font-size:15px}
.pill{display:inline-flex; align-items:center; gap:7px; border:1px solid var(--line); background:#fff; border-radius:999px; padding:7px 10px; color:var(--muted); font-size:11px; font-weight:800}
.pill .led{width:8px;height:8px;border-radius:50%;background:#2fd08f;box-shadow:0 0 0 4px rgba(47,208,143,.14)}
.info{background:rgba(255,255,255,.84); border:1px solid var(--line2); border-radius:14px; padding:12px; box-shadow:var(--shadow2)}
.info .lab{font-size:12px; color:var(--muted); margin-bottom:5px}
.info .val{font-size:16px; font-weight:800; line-height:1.12}
.info .sub{font-size:11px; color:var(--muted); margin-top:4px; line-height:1.3}
.section{margin-top:12px}
.section-head{display:flex; justify-content:space-between; align-items:flex-end; gap:10px; flex-wrap:wrap; padding:0 2px; margin-bottom:8px}
.section-head h2{margin:0; font-size:16px; letter-spacing:-.01em}
.section-head p{margin:0; color:var(--muted); font-size:12px}
.grid{display:grid; gap:12px}
.cards-2{grid-template-columns:repeat(2,1fr)}
.cards-3{grid-template-columns:repeat(3,1fr)}
.cards-4{grid-template-columns:repeat(4,1fr)}
.card{background:linear-gradient(180deg, rgba(255,255,255,.94), rgba(255,255,255,.78)); border:1px solid rgba(255,255,255,.82); border-radius:18px; box-shadow:var(--shadow2); padding:14px}
.kpi .lab{font-size:12px; color:var(--muted); margin-bottom:7px}
.kpi .val{font-size:22px; font-weight:800; line-height:1.05; letter-spacing:-.02em}
.kpi .sub{font-size:11px; color:var(--muted); margin-top:6px}
.navcard{display:grid; grid-template-columns:auto 1fr; gap:12px; align-items:start; min-height:146px}
.icon{width:46px; height:46px; border-radius:13px; display:grid; place-items:center; background:linear-gradient(135deg, rgba(191,244,223,.95), rgba(220,238,255,.95)); border:1px solid rgba(20,103,92,.10); color:#12675d}
.icon svg{width:23px;height:23px}
.navcard h3{margin:0; font-size:16px}
.navcard p{margin:6px 0 10px; color:var(--muted); font-size:13px; line-height:1.4}
.nav-actions{display:flex; gap:8px; flex-wrap:wrap}
.footer{margin-top:12px; padding:12px 14px; border-radius:16px; border:1px solid rgba(255,255,255,.80); background:linear-gradient(180deg, rgba(255,255,255,.88), rgba(255,255,255,.74)); box-shadow:var(--shadow2); display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap}
.footer .small{font-size:12px; color:var(--muted); line-height:1.35}
.footer .small strong{color:var(--ink)}
.footer .chip{padding:7px 11px; border-radius:999px; border:1px solid var(--line2); background:#fff; color:var(--teal); font-size:11px; font-weight:800}
.muted{color:var(--muted)}
code{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; font-size:.92em; background:rgba(255,255,255,.75); border:1px solid var(--line2); padding:2px 6px; border-radius:8px}
@media (max-width:1060px){ .hero{grid-template-columns:1fr} }
@media (max-width:860px){ .cards-4{grid-template-columns:repeat(2,1fr)} .cards-3{grid-template-columns:1fr} .cards-2{grid-template-columns:1fr} }
@media (max-width:560px){ main{width:min(1180px, calc(100% - 16px)); margin-top:8px} .hero-main,.hero-side{padding:14px} .navcard{grid-template-columns:1fr; min-height:auto} .footer .chip{width:100%; text-align:center} }
</style>
</head>
<body>
  <div class="orb a" aria-hidden="true"></div>
  <div class="orb b" aria-hidden="true"></div>
  <main>
    <div class="topbar">
      <div class="brand"><span class="dot" aria-hidden="true"></span><span>Observatorio ambiental · Sololá · Módulo Reforestación</span></div>
      <div class="actions">
        <a class="btn outline" href="../../index.html">← Portal principal</a>
        <a class="btn outline" href="../../data/puntos.geojson">Datos GeoJSON</a>
      </div>
    </div>

    <section class="hero">
      <article class="panel hero-main">
        <div class="kicker">
          <span class="badge"> Reforestación</span>
          <span class="badge"><span class="led"></span> Módulo operativo</span>
        </div>
        <h1>Entrada del módulo de reforestación de Sololá</h1>
        <p>
          Esta pantalla sirve para navegar rápido entre el geoportal, el dashboard y los informes del módulo.
          Aquí solo se muestra un resumen mínimo para no repetir análisis entre pantallas.
        </p>
        <div class="actions">
          <a class="btn primary" href="./geoportal.html"> Geoportal</a>
          <a class="btn outline" href="./dashboard.html"> Dashboard</a>
          <a class="btn outline" href="./informes.html"> Informes</a>
        </div>
      </article>

      <aside class="panel hero-side" aria-label="Estado del módulo">
        <div class="side-title">
          <h2>Estado del módulo</h2>
          <span class="pill" id="chipEstado"><span class="led"></span> En línea</span>
        </div>
        <div class="info">
          <div class="lab">Última actualización</div>
          <div class="val" id="st_update">—</div>
          <div class="sub">Lectura desde <code>../../data/resumen.json</code></div>
        </div>
        <div class="info">
          <div class="lab">Flujo de datos</div>
          <div class="val" id="syncText">Verificando…</div>
          <div class="sub">KoBo → GitHub Actions → GitHub Pages</div>
        </div>
        <div class="info">
          <div class="lab">Ruta del módulo</div>
          <div class="val">/apps/reforestacion/</div>
          <div class="sub">Enlaces internos locales a este directorio</div>
        </div>
      </aside>
    </section>

    <section class="section">
      <div class="section-head">
        <div>
          <h2>Navegación principal</h2>
          <p>Cada pantalla cumple una función distinta para evitar duplicación</p>
        </div>
      </div>
      <div class="grid cards-3">
        <article class="card navcard">
          <div class="icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M3 6l7-3 4 2 7-2v15l-7 2-4-2-7 3V6z"/><path d="M10 3v15M14 5v15"/></svg></div>
          <div>
            <h3>Geoportal</h3>
            <p>Consulta espacial y exploración de puntos. Aquí va la experiencia cartográfica, no el análisis estadístico profundo.</p>
            <div class="nav-actions"><a class="btn primary" href="./geoportal.html">Abrir geoportal</a></div>
          </div>
        </article>
        <article class="card navcard">
          <div class="icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M4 19h16"/><path d="M7 16V9"/><path d="M12 16V5"/><path d="M17 16v-4"/></svg></div>
          <div>
            <h3>Dashboard</h3>
            <p>Análisis de patrones, estadísticas y visualización cuantitativa. Aquí vive el tablero técnico.</p>
            <div class="nav-actions"><a class="btn outline" href="./dashboard.html">Abrir dashboard</a></div>
          </div>
        </article>
        <article class="card navcard">
          <div class="icon" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M7 3h8l4 4v14H7z"/><path d="M15 3v5h5"/><path d="M10 13h6M10 17h6"/></svg></div>
          <div>
            <h3>Informes</h3>
            <p>Salida de reportes y productos. Puede mantenerse simple por ahora sin afectar la navegación del módulo.</p>
            <div class="nav-actions"><a class="btn outline" href="./informes.html">Abrir informes</a></div>
          </div>
        </article>
      </div>
    </section>

    <section class="section">
      <div class="section-head">
        <div>
          <h2>Resumen mínimo del módulo</h2>
          <p>Solo para ver estado y continuidad del flujo; el análisis se hace en el dashboard</p>
        </div>
      </div>
      <div class="grid cards-4">
        <div class="card kpi"><div class="lab">Boletas</div><div class="val" id="k_boletas">—</div><div class="sub">resumen.json</div></div>
        <div class="card kpi"><div class="lab">Plantas</div><div class="val" id="k_plantas">—</div><div class="sub">resumen.json</div></div>
        <div class="card kpi"><div class="lab">Participantes</div><div class="val" id="k_part">—</div><div class="sub">resumen.json</div></div>
        <div class="card kpi"><div class="lab">Puntos con coordenadas</div><div class="val" id="k_puntos">—</div><div class="sub">puntos.geojson</div></div>
      </div>
    </section>

    <section class="section">
      <div class="grid cards-2">
        <article class="card">
          <h3 style="margin:0 0 6px;font-size:15px">Evita confusión entre pantallas</h3>
          <p class="muted" style="margin:0;font-size:13px;line-height:1.42">Inicio del módulo = navegación. Geoportal = mapa. Dashboard = análisis. Informes = salidas. Así ya no se siente que todo repite lo mismo.</p>
        </article>
        <article class="card">
          <h3 style="margin:0 0 6px;font-size:15px">Rutas correctas para este archivo</h3>
          <p class="muted" style="margin:0;font-size:13px;line-height:1.42">Este archivo está diseñado para <code>/apps/reforestacion/index.html</code>. Por eso usa <code>./geoportal.html</code> y datos en <code>../../data/...</code>.</p>
        </article>
      </div>
    </section>

    <footer class="footer">
      <div class="small"><strong>Laboratorio SIG del eje de bosques de CODEMA-SOLOLÁ 2026</strong><br>Módulo Reforestación · Pantalla de navegación</div>
      <div class="chip" id="foot_update">Última actualización: —</div>
    </footer>
  </main>
  
<script>
(function(){
  const $ = (id)=>document.getElementById(id);
  const fmtNum = (v)=>{ const n=Number(v); return Number.isFinite(n) ? new Intl.NumberFormat('es-GT').format(n) : '—'; };
  const cleanText = (v)=>{
    if (v == null) return '—';
    let s = String(v).trim(); if (!s) return '—';
    s = s.replace(/_/g,' ').replace(/\s+/g,' ').trim();
    const fixes = {'Ã¡':'á','Ã©':'é','Ã­':'í','Ã³':'ó','Ãº':'ú','Ã':'Á','Ã‰':'É','Ã':'Í','Ã“':'Ó','Ãš':'Ú','Ã±':'ñ','Ã‘':'Ñ','Â':''};
    for (const [bad,good] of Object.entries(fixes)) s = s.split(bad).join(good);
    return s;
  };
  const fmtDate = (raw)=>{
    if (!raw) return '—';
    const txt = cleanText(raw);
    const d = new Date(txt);
    return isNaN(d.getTime()) ? txt : new Intl.DateTimeFormat('es-GT',{year:'numeric',month:'short',day:'2-digit',hour:'2-digit',minute:'2-digit'}).format(d);
  };
  const RESUMEN = '../../data/resumen.json';
  const PUNTOS = '../../data/puntos.geojson';

  fetch(RESUMEN,{cache:'no-store'})
    .then(r=>r.ok ? r.json() : null)
    .then(j=>{
      if (!j) throw new Error('No se pudo leer resumen.json');
      const boletas = j?.kpis?.total_boletas;
      const plantas = j?.kpis?.total_plantas;
      const part = j?.kpis?.total_participantes;
      const upd = fmtDate(j?.ultima_actualizacion);
      if ($('k_boletas')) $('k_boletas').textContent = fmtNum(boletas);
      if ($('k_plantas')) $('k_plantas').textContent = fmtNum(plantas);
      if ($('k_part')) $('k_part').textContent = fmtNum(part);
      if ($('k_update')) $('k_update').textContent = upd;
      if ($('st_update')) $('st_update').textContent = upd;
      if ($('foot_update')) $('foot_update').textContent = 'Última actualización: ' + upd;
      if ($('syncText')) $('syncText').textContent = Number(boletas||0) > 0 ? 'Sincronización activa' : 'Sin registros todavía';
    })
    .catch(()=>{
      if ($('st_update')) $('st_update').textContent = 'No disponible';
      if ($('foot_update')) $('foot_update').textContent = 'Última actualización: no disponible';
      if ($('syncText')) $('syncText').textContent = 'No se pudo leer resumen.json';
      const chip=$('chipEstado');
      if (chip) chip.innerHTML = '<span class="led" style="background:#f0b24d;box-shadow:0 0 0 4px rgba(240,178,77,.14)"></span> Estado no verificado';
    });

  fetch(PUNTOS,{cache:'no-store'})
    .then(r=>r.ok ? r.json() : null)
    .then(gj=>{ if (gj && Array.isArray(gj.features) && $('k_puntos')) $('k_puntos').textContent = fmtNum(gj.features.length); })
    .catch(()=>{});
})();
</script>

</body>
</html>
